---
sidebar: sidebar
permalink: data-protection/snapshot-replication.html
keywords: snapshot replication, asa r2, protect data, data protection, replication, replicate data, remote cluster, destination cluster, source cluster, replication relationship, asynchronous replication, synchronous replication
summary: Use Snapshot replication to copy data to a remote location for backup and disaster recovery.  Set up requires creation of a replication policy and relationship. 
---
= Set up Snapshot replication on the ASA r2
:icons: font
:imagesdir: ../media/

[.lead]
Snapshot replication is a process in which consistency groups on your ASA r2 are copied to a geographically remote location. After the initial data replication, changes to consistency groups are copied to the remote location based upon a replication policy. Replicated consistency groups can be used for disaster recovery or data migration.

To set up Snapshot replication, you need to create a replication policy and establish a replication relationship between your ASA r2 and the remote location. 

.Before you begin
A SnapMirror license is required to set up snapshot replication.

== Step 1: Create a snapshot replication policy

The snapshot replication policy defines when updates performed on the ASA r2 are replicated to the remote site.  

.Steps

. In System Manager, select *Protection > Policies*; then select *Replication policies*.
. Select image:icon_add_blue_bg.png[blue rectangle containing a plus sign followed by the word add in white letters].
. Enter a name for the replication policy or accept the default name; then enter a description.
. Select the *Policy scope*.
+
If you want to apply the replication policy to the entire cluster, select *Cluster*.   If you want the replication policy applied only to the storage units in a specific storage VM, select *Storage VM*.
. Select the *Policy type*.
+
[cols="2,6a" options="header"]
|===
// header row
| Option
| Steps

| Copy data to the remote site after it is written to the source.
a| 
.. Select *Asynchronous*.
.. Under *Transfer schedule*.
.. Select to transfer all snapshots or select to create rules to determine which snapshots to transfer.
.. Optionally, enable network compression.

| Write data to the source and remote sites simultaneously.  
a|
.. Select *Synchronous*.


// table end
|===

. Select *Save*.

.What's next?

You have created a snapshot replication policy and are now ready to create a replication relationship between your ASA r2 and your remote location.


.For more information
Learn more about link:../administer/manage-client-vm-access.html[storage VMs for client access].

== Step 2: Create a replication relationship

A snapshot replication relationship establishes a connection between your ASA r2 and a remote location so that you can replicate consistency groups to a remote cluster. Replicated consistency groups can be used for disaster recovery or for data migration. 

.Before you begin

If you want to create tamper-proof snapshots to protect against ransomware attacks, you must link:../secure-data/ransomware-protection.html#initialize-the-snaplock-compliance-clock[initialize the Snapshot compliance clock] before you create the replication relationship.

.Steps

. In System Manager, select *Protection > Replication*.
. Select *Local sources*, then select image:icon_replicate_blue_bg.png[rectangle with blue background and the word replicate in white letters] .
. Search for and select the source consistency group.
+
The _source_ consistency group refers to the consistency group on your ASA r2 that you want to replicate.
. Under *Replication destination*, select the cluster to replicate to; then select the storage VM.
. Select the replication policy.
+
The initial data transfer begins immediately by default.  To delay the start of the data transfer, select *Destination settings*, then deselect *Start transfer immediately*.
. Optionally, to override the default transfer schedule, select *Destination settings*, then select *Override transfer schedule*.
. Select *Save*. 

.What's next?

Now that you have created a replication policy and relationship, your initial data transfer begins as defined in your replication policy.  You can optionally test your replication failover to verify that successful failover can occur if your ASA r2 goes offline.

== Step 3: Test replication failover

Optionally, validate that you can successfully serve data from replicated storage units on a remote cluster if the source cluster is offline.  

.Steps

. In System Manager, select *Protection > Replication*.
. Hover over the replication relationship you want to test, then select image:icon_kabob.gif[three vertical blue dots].
. Select *Test failover*.
. Enter the failover information, then select *Test failover*.

.What's next?

Now that your data is protect with snapshot replication for disaster recovery, you should link:../secure-data/encrypt-data-at-rest.html[encrypt your data at rest] so that it can't be read if a disk in your ASA r2 is repurposed, returned, misplaced or stolen.


// ONTAPDOC 1927, 2024 Sept 24